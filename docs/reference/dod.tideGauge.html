<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Download tide-gauge data — dod.tideGauge • dod</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Download tide-gauge data — dod.tideGauge"><meta name="description" content="dod.tideGauge() downloads tide-gauge data from either
Canadian (CHS) or American (NOAA) tide gauges."><meta property="og:description" content="dod.tideGauge() downloads tide-gauge data from either
Canadian (CHS) or American (NOAA) tide gauges."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">dod</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.14</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/buoy.html">Downloading buoy Data</a></li>
    <li><a class="dropdown-item" href="../articles/ctd.html">Downloading ctd Data</a></li>
    <li><a class="dropdown-item" href="../articles/dod_package.html">Package Overview</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/dankelley/dod/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Download tide-gauge data</h1>
      <small class="dont-index">Source: <a href="https://github.com/dankelley/dod/blob/HEAD/R/tide_gauge.R" class="external-link"><code>R/tide_gauge.R</code></a></small>
      <div class="d-none name"><code>dod.tideGauge.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>dod.tideGauge()</code> downloads tide-gauge data from either
Canadian (CHS) or American (NOAA) tide gauges.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">dod.tideGauge</span><span class="op">(</span></span>
<span>  ID <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"water_level"</span>,</span>
<span>  agency <span class="op">=</span> <span class="st">"CHS"</span>,</span>
<span>  start <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  end <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  resolution <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  file <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  destdir <span class="op">=</span> <span class="st">"."</span>,</span>
<span>  age <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  debug <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-id">ID<a class="anchor" aria-label="anchor" href="#arg-id"></a></dt>
<dd><p>a character (or possibly integer) value specifying the
numeric identifier of the tide gauge. For Canadian data, this
is either the station number or the station name (e.g. number 491
corresponds to the "Bedford Institute" station).  For American
data, it is a numerical code.</p></dd>


<dt id="arg-variable">variable<a class="anchor" aria-label="anchor" href="#arg-variable"></a></dt>
<dd><p>a character value indicating the name of the variable to be
downloaded.  This defaults to <code>"water_level"</code> for observed water level
(called <code>"wlo"</code> on the CHS server and <code>"water_level"</code> on the NOAA server).
Another permitted choice is <code>"predictions"</code> (called <code>"wlp"</code> by CHS and
<code>"predictions"</code> by NOAA). In either of these two cases, <code>time</code> and <code>QC</code> are
also stored alongside the variable.  And there is a third case: if
<code>variable</code> is <code>"metadata"</code>, then the return value will a list containing
information about the station, such as its code number, its official name,
its datum, etc.</p></dd>


<dt id="arg-agency">agency<a class="anchor" aria-label="anchor" href="#arg-agency"></a></dt>
<dd><p>a character value indicating the agency from which data will
be sought. Use <code>"CHS"</code> for Canadian tide gauges (the default), or <code>"NOAA"</code>
for American tide gauges.</p></dd>


<dt id="arg-start-end">start, end<a class="anchor" aria-label="anchor" href="#arg-start-end"></a></dt>
<dd><p>POSIXt times or character values that can be converted to
such times (via <code><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct()</a></code> with <code>tz="UTC"</code>) that indicate the time
interval for the requested data.  If <code>end</code> is not specified, then the
present time is used.  If <code>start</code> is not provided, then it is set to the
present time minus 7 days.  If <code>start</code> is a numeric value, then it is
interpreted as the number of days to go back in time from the <code>end</code> time.</p></dd>


<dt id="arg-resolution">resolution<a class="anchor" aria-label="anchor" href="#arg-resolution"></a></dt>
<dd><p>character value indicating the resolution, only used if
<code>agency="CHS"</code>.  The choices are <code>"ONE_MINUTE"</code>, <code>"THREE_MINUTES"</code> (the
default), <code>"FIVE_MINUTES"</code>, <code>"FIFTEEN_MINUTES"</code>, and <code>"SIXTY_MINUTES"</code>.  The
website that serves the data indicates that not all resolutions are
available for all stations and/or time intervals, and that the maximum time
range of a request depends on the requested resolution.</p></dd>


<dt id="arg-file">file<a class="anchor" aria-label="anchor" href="#arg-file"></a></dt>
<dd><p>a character value indicating the name to be used for the
downloaded data.  If not provided, this is constructed as e.g.
<code>"tide_A_N_S_E_R_V.csv"</code> where <code>A</code> is the value of the agency argument, <code>N</code>
is the station ID number, <code>S</code> and <code>E</code> are the start and end dates written in
8-digit format (i.e. sans the <code>"-"</code> characters), <code>R</code> is the resolution in
minutes, and <code>V</code> is the variable name.</p></dd>


<dt id="arg-destdir">destdir<a class="anchor" aria-label="anchor" href="#arg-destdir"></a></dt>
<dd><p>a character value indicating the directory
in which to store downloaded files.</p></dd>


<dt id="arg-age">age<a class="anchor" aria-label="anchor" href="#arg-age"></a></dt>
<dd><p>a numerical value indicating a time interval, in days.
If the file to be downloaded from the server already exists
locally, and was created less than <code>age</code> days in the past, it will
not be downloaded again.  Setting <code>age=0</code> forces a download, so
that existing files will always be updated. By contrast, setting
<code>age</code> to a negative number prevents the updating of files that
already exist locally, regardless of their age.</p></dd>


<dt id="arg-quiet">quiet<a class="anchor" aria-label="anchor" href="#arg-quiet"></a></dt>
<dd><p>a logical value, passed to <code><a href="https://jeroen.r-universe.dev/curl/reference/curl_download.html" class="external-link">curl::curl_download()</a></code>, which does
the downloading.  If this is TRUE (the default), then the work is done
quietly. Until version version 0.1.12, this parameter was called <code>silent</code>,
but it was renamed to match the corresponding argument in
<code><a href="https://jeroen.r-universe.dev/curl/reference/curl_download.html" class="external-link">curl::curl_download()</a></code>, which may be more familiar to users.</p></dd>


<dt id="arg-debug">debug<a class="anchor" aria-label="anchor" href="#arg-debug"></a></dt>
<dd><p>an integer value indicating the level of debugging. If
this exceeds 0, then some debugging messages will be printed. This
value is passed down to related functions, but with 1 subtracted
for each pass.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>dod.tideGauge()</code> returns a list, if <code>value</code> is <code>"metadata"</code>
and <code>agency</code> is <code>"CHS"</code>; otherwise it returns a file name (with
full path included).  For the CHS case this is a constructed filename,
since the CHS server provides data, not files.  For the
NOAA case, it is a downloaded file.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Downloads are done from for either the Canadian Hydrographic Service (CHS)
or from the American National Oceanographic and Atmospheric Agency (NOAA),
respectively (see References 1 and 2). The resultant data are saved in
either constructed filenames, or filenames provided by the user; in either
case, if a recent file already exists with the indicated name, then no data
are downloaded.
For NOAA files, water level and predictions are provided on the same time
sequence, but for CHS files, this is not the case, e.g. predictions (in the
author's tests) are on 15 minute intervals, starting at an hour marker, but
observations may be at a variety of times, depending <code>start</code> and <code>end</code>.
Therefore, numerical comparision with CHS data will require interpolation
(see ‘Examples’).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>

<ol><li><p><a href="https://api.iwls-sine.azure.cloud-nuage.dfo-mpo.gc.ca/swagger-ui/index.html" class="external-link">https://api.iwls-sine.azure.cloud-nuage.dfo-mpo.gc.ca/swagger-ui/index.html</a></p></li>
<li><p><a href="https://api.tidesandcurrents.noaa.gov/api/prod/" class="external-link">https://api.tidesandcurrents.noaa.gov/api/prod/</a></p></li>
</ol></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other functions that download files:
<code><a href="dod.amsr.html">dod.amsr</a>()</code>,
<code><a href="dod.buoy.html">dod.buoy</a>()</code>,
<code><a href="dod.coastline.html">dod.coastline</a>()</code>,
<code><a href="dod.ctd.html">dod.ctd</a>()</code>,
<code><a href="dod.ctd.bats.html">dod.ctd.bats</a>()</code>,
<code><a href="dod.ctd.bbmp.html">dod.ctd.bbmp</a>()</code>,
<code><a href="dod.ctd.gtspp.html">dod.ctd.gtspp</a>()</code>,
<code><a href="dod.ctd.itp.html">dod.ctd.itp</a>()</code>,
<code><a href="dod.met.html">dod.met</a>()</code>,
<code><a href="dod.topo.html">dod.topo</a>()</code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Dan Kelley</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Download and plot tide-guage data for Halifax Harbour</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span> <span class="co"># sidestep a pkgdown::build_site() error</span></span></span>
<span class="r-in"><span>    <span class="co"># NOTE: data file is removed at end, to pass CRAN checks</span></span></span>
<span class="r-in"><span>    <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dankelley.github.io/dod/">dod</a></span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dankelley.github.io/oce/" class="external-link">oce</a></span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">destdir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">ofile</span> <span class="op">&lt;-</span> <span class="fu">dod.tideGauge</span><span class="op">(</span><span class="fl">491</span>, destdir <span class="op">=</span> <span class="va">destdir</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">pfile</span> <span class="op">&lt;-</span> <span class="fu">dod.tideGauge</span><span class="op">(</span><span class="fl">491</span>, <span class="st">"predictions"</span>, destdir <span class="op">=</span> <span class="va">destdir</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">O</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">ofile</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">O</span><span class="op">$</span><span class="va">time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="va">O</span><span class="op">$</span><span class="va">Date.Time</span>, <span class="st">"%Y-%m-%d %H:%M:%S"</span>, tz <span class="op">=</span> <span class="st">"UTC"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">P</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">pfile</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">P</span><span class="op">$</span><span class="va">time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="va">P</span><span class="op">$</span><span class="va">Date.Time</span>, <span class="st">"%Y-%m-%d %H:%M:%S"</span>, tz <span class="op">=</span> <span class="st">"UTC"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="co"># Top panel: observation (black) and prediction (gray)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://dankelley.github.io/oce/reference/oce.plot.ts.html" class="external-link">oce.plot.ts</a></span><span class="op">(</span><span class="va">O</span><span class="op">$</span><span class="va">time</span>, <span class="va">O</span><span class="op">$</span><span class="va">Water.Level</span>, ylab <span class="op">=</span> <span class="st">"Water Level [m]"</span>, xaxs <span class="op">=</span> <span class="st">"i"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">P</span><span class="op">$</span><span class="va">time</span>, <span class="va">P</span><span class="op">$</span><span class="va">Predictions</span>, col <span class="op">=</span> <span class="st">"gray"</span>, type <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="co"># Bottom panel: misfit. Note the interpolation to observation time.</span></span></span>
<span class="r-in"><span>    <span class="va">misfit</span> <span class="op">&lt;-</span> <span class="va">O</span><span class="op">$</span><span class="va">Water.Level</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/approxfun.html" class="external-link">approx</a></span><span class="op">(</span><span class="va">P</span><span class="op">$</span><span class="va">time</span>, <span class="va">P</span><span class="op">$</span><span class="va">Predictions</span>, <span class="va">O</span><span class="op">$</span><span class="va">time</span><span class="op">)</span><span class="op">$</span><span class="va">y</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://dankelley.github.io/oce/reference/oce.plot.ts.html" class="external-link">oce.plot.ts</a></span><span class="op">(</span><span class="va">O</span><span class="op">$</span><span class="va">time</span>, <span class="va">misfit</span>, ylab <span class="op">=</span> <span class="st">"Deviation [m]"</span>, xaxs <span class="op">=</span> <span class="st">"i"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="va">destdir</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Dan Kelley, Annie Howard, Jaimie Harbin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

