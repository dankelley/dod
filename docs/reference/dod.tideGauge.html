<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="dod.tideGauge() downloads tide-gauge data from either
Canadian (CHS) or American (NOAA) tide gauges."><title>Download tide-gauge data — dod.tideGauge • dod</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Download tide-gauge data — dod.tideGauge"><meta property="og:description" content="dod.tideGauge() downloads tide-gauge data from either
Canadian (CHS) or American (NOAA) tide gauges."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">dod</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.8</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/buoy.html">Downloading buoy Data</a>
    <a class="dropdown-item" href="../articles/ctd.html">Downloading ctd Data</a>
    <a class="dropdown-item" href="../articles/dod_package.html">Package Overview</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/dankelley/dod/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Download tide-gauge data</h1>
      <small class="dont-index">Source: <a href="https://github.com/dankelley/dod/blob/HEAD/R/tide_gauge.R" class="external-link"><code>R/tide_gauge.R</code></a></small>
      <div class="d-none name"><code>dod.tideGauge.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>dod.tideGauge()</code> downloads tide-gauge data from either
Canadian (CHS) or American (NOAA) tide gauges.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">dod.tideGauge</span><span class="op">(</span></span>
<span>  ID <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"water_level"</span>,</span>
<span>  agency <span class="op">=</span> <span class="st">"CHS"</span>,</span>
<span>  start <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  end <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  resolution <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  file <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  destdir <span class="op">=</span> <span class="st">"."</span>,</span>
<span>  age <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  debug <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>ID</dt>
<dd><p>a character (or possibly integer) value specifying the
numeric identifier of the tide gauge. For Canadian data, this
is either the station number or the station name (e.g. number 491
corresponds to the "Bedford Institute" station).  For American
data, it is a numerical code.</p></dd>


<dt>variable</dt>
<dd><p>a character value indicating the name of the variable to
be downloaded.  This defaults to <code>"water_level"</code> for observed water
level (called <code>"wlo"</code> on the CHS server and <code>"water_level"</code> on the NOAA server).
Another permitted choice is <code>"predictions" (called </code>"wlp"<code>by CHS and</code>"predictions"<code>by NOAA). In either of these two cases,</code>time<code>and</code>QC<code>are also stored alongside the variable.  But there is a third case: if</code>variable<code>is</code>"metadata"`,
then <em>no</em> file is saved; instead, the return value is a list containing
information about the station, such as its code number, its official
name, its datum, etc.</p></dd>


<dt>agency</dt>
<dd><p>a character value indicating the agency from which data will be
sought. Use <code>"CHS" for Canadian tide gauges (the default), or </code>"NOAA"` for
American tide gauges.</p></dd>


<dt>start, end</dt>
<dd><p>POSIXt times or character values that can be converted
to such times (via <code><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct()</a></code> with <code>tz="UTC"</code>) that indicate
the time interval for the requested data.  If <code>end</code> is not specified,
then the present time is used.  If <code>start</code> is not provided, then
it is set to the present time minus 7 days.  If <code>start</code> is a
numeric value, then it is interpreted as the number of days
to go back in time from the <code>end</code> time.</p></dd>


<dt>resolution</dt>
<dd><p>character value indicating the resolution, only used
if <code>agency</code> is <code>"CHS"</code>.  The choices are <code>"ONE_MINUTE", </code>"THREE_MINUTES"<code>(the default),</code>"FIVE_MINUTES"<code>, </code>"FIFTEEN_MINUTES"<code>, and </code>"SIXTY_MINUTES"<code>.  The server website indicates that </code>"Not all resolution are available for every station and every time series."`
It also indicates that
"The time frame available increases with the resolution, it is equal
to a week (7 days) multiplied by the resolution, but the maximum
available is 31 days. (a month)".  This second statement perhaps
means that it is possible to download at most 1 week of data for
1-minute resolution.</p></dd>


<dt>file</dt>
<dd><p>a character value indicating the name to be used for the
downloaded data.  If not provided, this is constructed as e.g.
<code>"tide_A_N_S_E_R_V.csv"</code> where <code>A</code> is the value of the agency argument, <code>N</code> is
the station ID number, <code>S</code> and <code>E</code> are the start and end dates written in
8-digit format (i.e. sans the <code>"-"</code> characters), <code>R</code> is the resolution in
minutes, and <code>V</code> is the variable name.</p></dd>


<dt>destdir</dt>
<dd><p>a character value indicating the directory
in which to store downloaded files.</p></dd>


<dt>age</dt>
<dd><p>a numerical value indicating a time interval, in days.
If the file to be downloaded from the server already exists locally,
and was created less than <code>age</code> days in the past, it will not be
downloaded again.  Setting <code>age=0</code> (which is the default)
forces a download, so that existing files will always be updated.
By contrast, setting <code>age</code> to a negative number prevents the
updating of files that already exist locally.</p></dd>


<dt>debug</dt>
<dd><p>an integer value indicating the level of debugging. If
this exceeds 0, then some debugging messages will be printed. This
value is passed down to related functions, but with 1 subtracted
for each pass.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p><code>dod.tideGauge()</code> returns a list, if <code>value</code> is <code>"metadata"</code></p>


<p>and <code>agency</code> is <code>"CHS"</code>; otherwise it returns a file name (with
full path included).  For the CHS case this is a constructed filename,
since the CHS server provides data, not files.  For the
NOAA case, it is a downloaded file.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Downloads are done from for either the Canadian Hydrographic Service (CHS) or
from the American National Oceanographic and Atmospheric
Agency (NOAA), respectively (see References 1 and 2). The resultant data are saved in
either constructed filenames, or filenames provided by the user;
in either case, if a recent file already exists with the indicated name,
then no data are downloaded.</p>
<p>For NOAA files, water level and predictions are provided on the same
time sequence, but for CHS files, this is not the case, e.g. predictions
(in the author's tests) are on 15 minute intervals, starting at an
hour marker, but observations may be at a variety of times, depending
<code>start</code> and <code>end</code>.  Therefore, numerical comparision with CHS data
will require interpolation (see ‘Examples’).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    
<ol><li><p>https://api-iwls.dfo-mpo.gc.ca/swagger-ui/index.html</p></li>
<li><p>https://api.tidesandcurrents.noaa.gov/api/prod/datagetter</p></li>
</ol></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dankelley.github.io/dod/" class="external-link">dod</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dankelley.github.io/oce/" class="external-link">oce</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ofile</span> <span class="op">&lt;-</span> <span class="fu">dod.tideGauge</span><span class="op">(</span><span class="fl">491</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pfile</span> <span class="op">&lt;-</span> <span class="fu">dod.tideGauge</span><span class="op">(</span><span class="fl">491</span>, <span class="st">"predictions"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">O</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">ofile</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">O</span><span class="op">$</span><span class="va">time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="va">O</span><span class="op">$</span><span class="va">Date.Time</span>, tz <span class="op">=</span> <span class="st">"UTC"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">P</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">pfile</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">P</span><span class="op">$</span><span class="va">time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="va">P</span><span class="op">$</span><span class="va">Date.Time</span>, tz <span class="op">=</span> <span class="st">"UTC"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Top panel: observation (black) and prediction (gray)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://dankelley.github.io/oce/reference/oce.plot.ts.html" class="external-link">oce.plot.ts</a></span><span class="op">(</span><span class="va">O</span><span class="op">$</span><span class="va">time</span>, <span class="va">O</span><span class="op">$</span><span class="va">Water.Level</span>, ylab <span class="op">=</span> <span class="st">"Water Level [m]"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">P</span><span class="op">$</span><span class="va">time</span>, <span class="va">P</span><span class="op">$</span><span class="va">Predictions</span>, col <span class="op">=</span> <span class="st">"gray"</span>, type <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Bottom panel: misfit. Note the interpolation to observation time.</span></span></span>
<span class="r-in"><span><span class="va">misfit</span> <span class="op">&lt;-</span> <span class="va">O</span><span class="op">$</span><span class="va">Water.Level</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/approxfun.html" class="external-link">approx</a></span><span class="op">(</span><span class="va">P</span><span class="op">$</span><span class="va">time</span>, <span class="va">P</span><span class="op">$</span><span class="va">Predictions</span>, <span class="va">O</span><span class="op">$</span><span class="va">time</span><span class="op">)</span><span class="op">$</span><span class="va">y</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://dankelley.github.io/oce/reference/oce.plot.ts.html" class="external-link">oce.plot.ts</a></span><span class="op">(</span><span class="va">O</span><span class="op">$</span><span class="va">time</span>, <span class="va">misfit</span>, ylab <span class="op">=</span> <span class="st">"Deviation [m]"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Dan Kelley.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

