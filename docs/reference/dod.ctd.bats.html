<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Download CTD data from the Bermuda Atlantic Time Series program — dod.ctd.bats • dod</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Download CTD data from the Bermuda Atlantic Time Series program — dod.ctd.bats"><meta name="description" content="dod.ctd.bats() downloads CTD data from Bermuda Atlantic Time Series
(BATS) server, at http://batsftp.bios.edu/BATS/ctd/ASCII/.  Note that this
server does not provide an index, so users will need to visit the website
to determine IDs of interest, unless they already know them. Another problem
is that the data are in a nonstandard format that the oce package cannot
read, so a user may wish to write code to reframe the data as shown
in the &amp;#8216;Examples&amp;#8217; section."><meta property="og:description" content="dod.ctd.bats() downloads CTD data from Bermuda Atlantic Time Series
(BATS) server, at http://batsftp.bios.edu/BATS/ctd/ASCII/.  Note that this
server does not provide an index, so users will need to visit the website
to determine IDs of interest, unless they already know them. Another problem
is that the data are in a nonstandard format that the oce package cannot
read, so a user may wish to write code to reframe the data as shown
in the &amp;#8216;Examples&amp;#8217; section."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">dod</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.11</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/buoy.html">Downloading buoy Data</a></li>
    <li><a class="dropdown-item" href="../articles/ctd.html">Downloading ctd Data</a></li>
    <li><a class="dropdown-item" href="../articles/dod_package.html">Package Overview</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/dankelley/dod/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Download CTD data from the Bermuda Atlantic Time Series program</h1>
      <small class="dont-index">Source: <a href="https://github.com/dankelley/dod/blob/HEAD/R/ctd.bats.R" class="external-link"><code>R/ctd.bats.R</code></a></small>
      <div class="d-none name"><code>dod.ctd.bats.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>dod.ctd.bats()</code> downloads CTD data from Bermuda Atlantic Time Series
(BATS) server, at <a href="http://batsftp.bios.edu/BATS/ctd/ASCII/" class="external-link">http://batsftp.bios.edu/BATS/ctd/ASCII/</a>.  Note that this
server does not provide an index, so users will need to visit the website
to determine IDs of interest, unless they already know them. Another problem
is that the data are in a nonstandard format that the <code>oce</code> package cannot
read, so a user may wish to write code to reframe the data as shown
in the ‘Examples’ section.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">dod.ctd.bats</span><span class="op">(</span><span class="va">ID</span>, info <span class="op">=</span> <span class="cn">FALSE</span>, file <span class="op">=</span> <span class="cn">NULL</span>, destdir <span class="op">=</span> <span class="st">"."</span>, age <span class="op">=</span> <span class="fl">0</span>, debug <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-id">ID<a class="anchor" aria-label="anchor" href="#arg-id"></a></dt>
<dd><p>an integer specifying the ID of the file of interest.
This gets expanded to e.g. URL/b(ID)_ctd.txt or URL/b(ID)_ctd_QC.txt
if <code>info</code> is FALSE, or to URL/b(ID)_info.txt otherwise.</p></dd>


<dt id="arg-info">info<a class="anchor" aria-label="anchor" href="#arg-info"></a></dt>
<dd><p>a logical value.  If <code>info</code> is FALSE, which is the default, then
<code>dod.ctd.bats()</code> downloads the actual CTD data.  Alternatively, it downloads
a file holding information about sampling location, etc.</p></dd>


<dt id="arg-file">file<a class="anchor" aria-label="anchor" href="#arg-file"></a></dt>
<dd><p>character value giving the name to be used for the downloaded
file.  If <code>file</code> is NULL, which is the default, then the filename on the
server is used.</p></dd>


<dt id="arg-destdir">destdir<a class="anchor" aria-label="anchor" href="#arg-destdir"></a></dt>
<dd><p>a character value indicating the directory
in which to store downloaded files.</p></dd>


<dt id="arg-age">age<a class="anchor" aria-label="anchor" href="#arg-age"></a></dt>
<dd><p>a numerical value indicating a time interval, in days.
If the file to be downloaded from the server already exists
locally, and was created less than <code>age</code> days in the past, it will
not be downloaded again.  Setting <code>age=0</code> forces a download, so
that existing files will always be updated. By contrast, setting
<code>age</code> to a negative number prevents the updating of files that
already exist locally, regardless of their age.</p></dd>


<dt id="arg-debug">debug<a class="anchor" aria-label="anchor" href="#arg-debug"></a></dt>
<dd><p>an integer value indicating the level of debugging. If
this exceeds 0, then some debugging messages will be printed. This
value is passed down to related functions, but with 1 subtracted
for each pass.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>dod.ctd.bats()</code> returns the full pathname of the
downloaded file.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other functions that download CTD data:
<code><a href="dod.ctd.bbmp.html">dod.ctd.bbmp</a>()</code>,
<code><a href="dod.ctd.gtspp.html">dod.ctd.gtspp</a>()</code>,
<code><a href="dod.ctd.itp.html">dod.ctd.itp</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dankelley.github.io/dod/" class="external-link">dod</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Read info file</span></span></span>
<span class="r-in"><span><span class="va">infoFile</span> <span class="op">&lt;-</span> <span class="fu">dod.ctd.bats</span><span class="op">(</span>ID <span class="op">=</span> <span class="fl">10001</span>, info <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">info.names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"ID"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"dateDeployed"</span>, <span class="st">"dateRecovered"</span>, <span class="st">"decimalDateDeployed"</span>, <span class="st">"decimalDateRecovered"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"decimalDayDeployed"</span>, <span class="st">"timeDeployed"</span>, <span class="st">"timeRecovered"</span>, <span class="st">"latitudeDeployed"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"latitudeRecovered"</span>, <span class="st">"longitudeDeployed"</span>, <span class="st">"longitudeRecovered"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.delim</a></span><span class="op">(</span><span class="va">infoFile</span>, sep <span class="op">=</span> <span class="st">"\t"</span>, header <span class="op">=</span> <span class="cn">FALSE</span>, col.names <span class="op">=</span> <span class="va">info.names</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Read data file</span></span></span>
<span class="r-in"><span><span class="va">dataFile</span> <span class="op">&lt;-</span> <span class="fu">dod.ctd.bats</span><span class="op">(</span>ID <span class="op">=</span> <span class="fl">10001</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dataNames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"ID"</span>, <span class="st">"date"</span>, <span class="st">"latitude"</span>, <span class="st">"longitude"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"pressure"</span>, <span class="st">"depth"</span>, <span class="st">"temperature"</span>, <span class="st">"conductivity"</span>, <span class="st">"salinity"</span>, <span class="st">"oxygen"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"beamAttenuationCoefficient"</span>, <span class="st">"fluorescence"</span>, <span class="st">"PAR"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.delim</a></span><span class="op">(</span><span class="va">dataFile</span>, sep <span class="op">=</span> <span class="st">"\t"</span>, header <span class="op">=</span> <span class="cn">FALSE</span>, col.names <span class="op">=</span> <span class="va">dataNames</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use oce to construct a basic CTD object (using just some of the data),</span></span></span>
<span class="r-in"><span><span class="co"># and then to summarize and plot it.  Note that longitude in these files</span></span></span>
<span class="r-in"><span><span class="co"># is in degrees west, so they must be negated for use in oce.</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dankelley.github.io/oce/" class="external-link">oce</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">info</span><span class="op">$</span><span class="va">dateDeployed</span>, <span class="va">info</span><span class="op">$</span><span class="va">timeDeployed</span><span class="op">)</span>, format <span class="op">=</span> <span class="st">"%Y%m%d %H%M"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ctd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dankelley.github.io/oce/reference/as.ctd.html" class="external-link">as.ctd</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    salinity <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">salinity</span>, temperature <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">temperature</span>,</span></span>
<span class="r-in"><span>    pressure <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">pressure</span>, latitude <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">latitude</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    longitude <span class="op">=</span> <span class="op">-</span><span class="va">data</span><span class="op">$</span><span class="va">longitude</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, time <span class="op">=</span> <span class="va">time</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Add some extra things that are in at least some file. Units can also be added,</span></span></span>
<span class="r-in"><span><span class="co"># if known.</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">item</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"oxygen"</span>, <span class="st">"beamAttenuationCoefficient"</span>, <span class="st">"fluorescence"</span>, <span class="st">"PAR"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">ctd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dankelley.github.io/oce/reference/oceSetData.html" class="external-link">oceSetData</a></span><span class="op">(</span><span class="va">ctd</span>, <span class="va">item</span>, <span class="va">data</span><span class="op">[[</span><span class="va">item</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ctd</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ctd</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Dan Kelley.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

